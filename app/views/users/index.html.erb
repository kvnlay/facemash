<h1>All users</h1>
<div class= "container">
  <div class="row">
    <div class="col-lg-12 d-flex justify-content-around">
      <% @users.each do |user| %>
        <div class="col-md-4 user-card">
          <div class="media user-img">
            <%= gravatar_for user %>
          </div>
          <div class="media body">
              <% if current_user == user || current_user.friends.include?(user) %>
                <p><%= link_to user.name, user_path(user) %></p>
              <% else %>
                <% if current_user.sent_requests.pluck(:requested_id).include? user.id %>
                  <p><%= link_to user.name, user_path(user) %></p>
                  <%= button_tag 'Request pending', class: 'btn btn-warning btn-sm', disabled: true %>
                <%elsif current_user.received_requests.pluck(:requester_id).include? user.id %>
                  <p><%= link_to user.name, user_path(user) %></p>
                  <%= button_to 'Accept request', friendships_path(friend_id: user.id), method: :post, class: "btn btn-success btn-sm" %>
                <% else %>
                  <p><%= link_to user.name, user_path(user) %> 
                  <%= button_to "Add friend", friend_requests_path(requested_id: user.id), method: :post, class: 'btn btn-primary btn-sm'%>
                  </p>   
                <% end %>
              <% end %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>

